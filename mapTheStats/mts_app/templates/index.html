{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Map The Stats Home</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{gmaps}}&map_ids=cb1dc00f0b3c966b&callback=initMap&libraries=&v=weekly" defer></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <!-- <script type="text/javascript" src='https://storage.googleapis.com/map_the_stats/gz_2010_us_050_00_20m.js'></script> -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
    <script src="https://use.fontawesome.com/releases/v5.0.8/js/all.js"></script>
     <script src="epoly.js" type="text/javascript"> </script>
	<link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="https://m.w3newbie.com/you-tube.css">
    <script>
      const mapStyle = [
        {
            stylers: [{ visibility: "off" }],
        },
        {
            // featureType: "administrative.providence",
            // elementType: "labels.text.stroke",
            // stylers: [{ visibility: "off" }, { color: "#000000" }, {weight: 1}],
        },
        {
            featureType: "landscape",
            elementType: "geometry",
            stylers: [{ visibility: "off" }, { color: "#fcfcfc" }],
        },
        {
            featureType: "water",
            elementType: "geometry",
            stylers: [{ visibility: "on" }, { color: "#bfd4ff" }],
        },
        ];
            var map;

            function initMap() {
            map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: 40, lng: -100 },
            zoom: 4,
            minZoom: 3,
            maxZoom: 17,
            disableDefaultUI: true,
            styles: mapStyle,
        });
        // set up the style rules and events for google.maps.Data
        loadMapShapes();

        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function(){
            if (this.readyState == 4 && this.status == 200) {
                var state_data = JSON.parse(this.responseText);
            }
        }
        xmlhttp.open('GET', 'https://storage.googleapis.com/mapsdevsite/json/states.js', true)
        xmlhttp.send();
        
        map.data.setStyle({
            fillColor : 'blue',
            strokeWeight : 1
        })
        //click events
        map.data.addListener('mouseover', function(e){
            map.data.overrideStyle(e.feature, {fillColor : 'yellow'});
        })
        map.data.addListener('click', function(e){
            map.data.overrideStyle(e.feature, {fillColor : 'yellow'})
            var loc_id = e.feature.getProperty("STATE")
            var loc_name = e.feature.getProperty("NAME")
            var location = e.latLng;
            map.setCenter(location);
            map.setZoom(6);
            document.getElementById('hidden_location').value = loc_id;
            document.getElementById('hidden_name').value = loc_name;
        })
        map.data.addListener('mouseout', function(e){
            map.data.overrideStyle(e.feature, {fillColor : 'blue'});
        })
        }

        /** Loads the state boundary polygons from a GeoJSON source. */
        function loadMapShapes() {
        // load US state outline polygons from a GeoJson file
        map.data.loadGeoJson(
            "https://storage.googleapis.com/mapsdevsite/json/states.js",
            { idPropertyName: "STATE" }
        );
        // map.data.loadGeoJson(
        //     "https://storage.googleapis.com/map_the_stats/gz_2010_us_050_00_20m.js",
        //     { idPropertyName: "CENSUSAREA"}
        // )
        }
      </script>

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-md navbar-light bg-light sticky-top">
<div class="container-fluid">
    <a class="navbar-brand" href="/"><img class="logo" src= "{% static '/img/pin.png' %}" alt="Logo"><h1>MAP the STATS</h1></a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            <li class="nav-item"></li>
                <a class="nav-link" href="#about">About</a>
            </li>
            <li class="nav-item"></li>
                <a class="nav-link" href="#connect">Connect</a>
            </li>
        </ul>
    </div>
</div>
</nav>

<!--- Image Slider -->
<div id="slides" class="carousel slide" data-ride="carousel">
<ul class="carousel-indicators">
    <li data-target="#slides" data-slide-to="0" class="active"></li>
    <li data-target="#slides" data-slide-to="1"></li>
</ul>
<div class="carousel-inner">
    <div class="carousel-item active">
        <img class="slide-img" src="{% static '/img/blackbrick.jpeg' %}" alt="">
        <div class="carousel-caption">
            <h1 class="display-2">Where?</h1>
            <h3>Looking to head some place new? Check it out before you go. Get the Stats and make the best decisions for you</h3>
        </div>
    </div>
    <div class="carousel-item">
        <img class="slide-img" src="{% static '/img/blackbrick.jpeg' %}" alt="">
        <div class="carousel-caption">
            <h1 class="display-2">How?</h1>
            <h3>Simply choose a location on the map below and view the results. It's definitely worth your time, we promise</h3>
        </div>
    </div>
</div>
</div>

<!--- Jumbotron -->
<div class="container-fluid">
<div class="row jumbotron">
    <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9 col-xl-10">
        <p class="lead">To begin select a position on the map</p>
    </div>

    <div id="map"></div>
    <form action="/decipher_location_type" method="post">
        {% csrf_token %}
        <!-- Hidden input dynamically will change based on selected state -->
        <input type="hidden" value="" name="location_id" id="hidden_location">
        <input type="hidden" value = "" name="location_name" id="hidden_name">
        <input type="submit" value="Testing">
    </form>

    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-2">
        <a href="#"><button type="button" class="btn btn-outline-secondary">Get Stats</button></a>
    </div>
</div>
</div>

<!--- Display Section -->
<div class="conatiner-fluid padding">
<div class="row welcome text-center">
    <div class="col-12">
        <h1 class="display-4">Know your stuff</h1>
    </div>
    <hr class="line">
    <div class="col-12">
        {% if loc_type in request.session %}
            <h2>{selected_loc} stats:</h2>
            <ul>
                <li>Amount of people living in {selected_loc}: {census_population}</li>
                <li>Average income for {selected_loc} residents: {bea_average_income}</li>
                <li>Unemployment rate in {selected_loc}: {bls_unemployment}</li>
                <li>Percentage of people living below poverty in {selected_loc}: {census_poverty}</li>
            </ul>
        {% endif %}
        <p class="lead">Display results here</p>
    </div>
</div>
</div>

<!--- About -->
<div class="conatiner-fluid padding">
    <div class="row jumbotron text-center">
        <div class="col-12">
            <a id="about"><h1 class="display-4">About</h1></a>
        </div>
        <hr class="line">
        <div class="col-12">
            <p class="lead">Map the Stats is for people who like to move, people who can't stand still. It's for those who are on the go and want to be prepared. Map the Stats provides you with important information about your destination. We are here for you when you are on the move.</p>
        </div>
    </div>
    </div>

<!--- Connect -->
<div class="container-fluid padding">
<div class="row text-center padding">
    <div class="col-12">
        <a id="connect"><h1 class="display-4">Connect</h1></a>
    </div>
    <hr class="line">
    <div class="col-12 social padding">
        <p class="lead">We would love to know who you are! Please reach out to us on any of the following social media platforms.</p>
        <p class="lead">#mapthestats</p>
        <a class="social" href="#"><i class="fab fa-facebook"></i></a>
        <a class="social" href="#"><i class="fab fa-twitter"></i></a>
        <a class="social" href="#"><i class="fab fa-instagram"></i></a>
        <a class="social" href="#"><i class="fab fa-youtube"></i></a>
    </div>
</div>
</div>
</body>
</html>